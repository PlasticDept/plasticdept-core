<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <script src="js/auth-check.js"></script>
  <title>Outbound Job Assignment</title>
  <link rel="stylesheet" href="css/assignment-job.css" />
  <link rel="icon" type="image/png" href="img/reverse-logistic.png"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600,700&display=swap" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header-bar">
      <div class="logo-title">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
        Outbound Job Assignment
      </div>
      <div class="user-profile">
        <div class="avatar" id="userAvatar">JD</div>
        <span id="userFullName" class="user-full-name">Nama User</span>
        <button id="headerLogoutBtn" class="btn btn-secondary" title="Logout">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
          Logout
        </button>
      </div>
    </header>

    <!-- Control Panel -->
    <div class="control-panel">
      <!-- Left Section - System Settings -->
      <div class="panel-section">
        <div class="panel-title">System Settings</div>
        
        <!-- Shift Toggle -->
        <div class="toggle-group">
          <div class="toggle-option">
            <input type="radio" name="shiftType" id="shiftDay" value="Day" checked>
            <label for="shiftDay">Day Shift</label>
          </div>
          <div class="toggle-option">
            <input type="radio" name="shiftType" id="shiftNight" value="Night">
            <label for="shiftNight">Night Shift</label>
          </div>
        </div>
        
        <!-- System Mode Toggle -->
        <div class="toggle-group">
          <div class="toggle-option">
            <input type="radio" name="modeToggle" id="modePhoenix" value="phoenix" checked>
            <label for="modePhoenix">Phoenix</label>
          </div>
          <div class="toggle-option">
            <input type="radio" name="modeToggle" id="modeZLogix" value="zlogix">
            <label for="modeZLogix">Z-Logix</label>
          </div>
        </div>
        
        <!-- File Upload -->
        <div class="file-upload">
          <input type="file" id="fileInput" accept=".xlsx, .xls" />
          <label for="fileInput">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
            Choose File
          </label>
          <span class="file-name" id="fileName">No file chosen</span>
          <button id="uploadBtn" class="btn btn-primary">Upload</button>
        </div>
      </div>
      
      <!-- Middle Section - MP PIC Table -->
      <div class="panel-section">
        <div class="panel-title">Man Power PIC</div>
        <div id="mpPicTableContainer" class="mp-pic-table-container"></div>
      </div>
      
      <!-- Right Section - Settings Forms -->
      <div class="panel-section">
        <div class="panel-title">Performance Settings</div>
        
        <!-- Plan Target Form -->
        <div class="form-group">
          <input type="number" id="planTargetInput" class="form-control" placeholder="Target value" min="0">
          <select id="planTeamSelector" class="form-control">
            <option value="Sugity">Team Sugity</option>
            <option value="Reguler">Team Reguler</option>
          </select>
          <button id="setPlanTargetBtn" class="btn btn-primary">Set Target</button>
        </div>
        
        <!-- Man Power Form -->
        <div class="form-group">
          <input type="number" id="manPowerInput" class="form-control" placeholder="Man power count" min="0">
          <select id="manPowerTeamSelector" class="form-control">
            <option value="Sugity">Team Sugity</option>
            <option value="Reguler">Team Reguler</option>
          </select>
          <button id="setManPowerBtn" class="btn btn-primary">Set MP</button>
        </div>
        
        <!-- MP Overtime Form -->
        <div class="form-group">
          <input type="number" id="mpOvertimeInput" class="form-control" placeholder="MP Overtime" min="0">
          <button id="setMpOvertimeBtn" class="btn btn-primary">Set MP OT</button>
        </div>
        
        <!-- MP PIC Form -->
        <div class="form-group">
          <select id="mpPicSelector" class="form-control">
            <option value="">-- Select PIC --</option>
            <!-- Options filled by JS -->
          </select>
          <select id="mpPicTeamSelector" class="form-control">
            <option value="Sugity">Team Sugity</option>
            <option value="Reguler">Team Reguler</option>
          </select>
          <button id="setMpPicBtn" class="btn btn-primary">Set MP PIC</button>
        </div>
      </div>
    </div>

    <!-- Toolbar -->
    <div class="toolbar">
      <button id="bulkAddBtn" class="btn btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
        Assign Selected Jobs
      </button>
      
      <div class="filter-dropdown" id="statusFilterDropdown">
        <button class="filter-dropdown-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>
          Filter by Status
        </button>
        <div class="filter-dropdown-menu">
          <select id="statusOptions" class="form-control">
            <option value="all">-- Show All --</option>
            <!-- Options filled by JS -->
          </select>
        </div>
      </div>
      
      <div class="filter-dropdown" id="dateFilterDropdown">
        <button class="filter-dropdown-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Filter by Date
        </button>
        <div class="filter-dropdown-menu">
          <select id="dateOptions" class="form-control">
            <option value="all">-- Show All --</option>
            <!-- Options filled by JS -->
          </select>
        </div>
      </div>
      
      <div class="filter-dropdown" id="teamFilterDropdown">
        <button class="filter-dropdown-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
          Filter by Team
        </button>
        <div class="filter-dropdown-menu">
          <select id="teamOptions" class="form-control">
            <option value="all">-- Show All --</option>
            <!-- Options filled by JS -->
          </select>
        </div>
      </div>
      
      <div class="toolbar-links">
        <a href="team-sugity.html" class="btn btn-secondary">Team Sugity Target</a>
        <a href="team-reguler.html" class="btn btn-secondary">Team Reguler Target</a>
        <a href="dashboard.html" class="btn btn-secondary">Dashboard</a>
        <a href="achievement.html" class="btn btn-secondary">Achievement</a>
        <a href="report.html" class="btn btn-secondary">Daily Report</a>
      </div>
      
      <button id="clearDatabaseBtn" class="btn btn-danger">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
        Delete Prev Data
      </button>
      
      <button id="exportExcelBtn" class="btn btn-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
        Save to Database
      </button>
    </div>

    <!-- Filter Indicator -->
    <div id="filterIndicator" class="filter-indicator"></div>

    <!-- Table Container -->
    <div class="table-container">
      <table id="jobTable">
        <thead>
          <tr>
            <th width="40px"><input type="checkbox" id="selectAll" /></th>
            <th onclick="sortTableBy('jobNo')" data-key="jobNo">Job No</th>
            <th onclick="sortTableBy('deliveryDate')" data-key="deliveryDate">Delivery Date</th>
            <th onclick="sortTableBy('deliveryNote')" data-key="deliveryNote">Delivery Note</th>
            <th onclick="sortTableBy('remark')" data-key="remark">Remark</th>
            <th onclick="sortTableBy('status')" data-key="status" width="100px">Status</th>
            <th onclick="sortTableBy('qty')" data-key="qty" width="100px">Qty</th>
            <th onclick="sortTableBy('team')" data-key="team" width="100px">Team</th>
            <th width="180px">Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
      <div class="notification-content">
        <div class="notification-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
        </div>
        <div class="notification-message">
          <div class="notification-title">Success</div>
          <div class="notification-text" id="notificationText">Action completed successfully</div>
        </div>
      </div>
    </div>

    <!-- Modal - Assign Job -->
    <div class="modal-backdrop" id="assignModalBackdrop">
      <div class="modal" id="assignModal">
        <div class="modal-header">
          <h3 class="modal-title">Assign Job</h3>
          <button class="modal-close" id="closeAssignModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="teamSelect">Team</label>
            <select id="teamSelect" class="form-control">
              <option value="Reguler">Reguler</option>
              <option value="Sugity">Sugity</option>
            </select>
          </div>
          <div class="form-group">
            <label for="jobTypeSelect">Job Type</label>
            <select id="jobTypeSelect" class="form-control">
              <option value="Remaining">Remaining</option>
              <option value="Additional">Additional</option>
              <option value="OT">OT</option>
              <option value="H-1">H-1</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancelAssign">Cancel</button>
          <button class="btn btn-primary" id="confirmAdd">Assign</button>
        </div>
      </div>
    </div>

    <!-- Modal - Confirm -->
    <div class="modal-backdrop" id="confirmModalBackdrop">
      <div class="modal" id="confirmModal">
        <div class="modal-header">
          <h3 class="modal-title" id="confirmModalTitle">Confirmation</h3>
          <button class="modal-close" id="closeConfirmModal">&times;</button>
        </div>
        <div class="modal-body">
          <p id="confirmModalMessage"></p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancelConfirmBtn">Cancel</button>
          <button class="btn btn-primary" id="okConfirmBtn">Confirm</button>
        </div>
      </div>
    </div>

    <!-- Modal - Logout -->
    <div class="modal-backdrop" id="logoutModalBackdrop">
      <div class="modal" id="logoutModal">
        <div class="modal-header">
          <h3 class="modal-title">Logout Confirmation</h3>
          <button class="modal-close" id="closeLogoutModal">&times;</button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to logout?</p>
          <p><small>Your session will be terminated.</small></p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancelLogoutBtn">Cancel</button>
          <button class="btn btn-danger" id="confirmLogoutBtn">Logout</button>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="exportLoadingOverlay" class="loader-overlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <p>Processing, please wait...</p>
      </div>
    </div>
  </div>

  <script type="module" src="js/config.js"></script>
  <script src="js/compatibility.js"></script>
  <script type="module" src="js/assignment-job-ui.js"></script>
  <script type="module" src="js/sortir.js"></script>
</body>
</html>